# Epic 8 Retrospective - UX Polish

**Date:** 2025-12-31
**Facilitator:** Bob (Scrum Master)
**Participants:** Alice (Product Owner), Charlie (Senior Dev), Dana (QA Engineer), Elena (Junior Dev), Jongkuk Lim (Project Lead)

---

## Epic Summary

| Metric | Value |
|--------|-------|
| **Epic** | Epic 8: UX Polish |
| **Goal** | Improve dashboard glanceability for observation-only use case |
| **Stories Completed** | 14/14 (100%) |
| **Origin** | Systematic UX elicitation session (C→B→A methodology) |
| **Key Insight** | "Dashboard is observation-only tool - users observe, don't take actions" |

### Stories Delivered

| Story | Title | Priority | Key Achievement |
|-------|-------|----------|-----------------|
| 8-1 | Recursive File Watching | Critical | Subdirectory changes now trigger activity updates |
| 8-2 | Auto-Refresh Reliability | Critical | 5-second tick handles waiting count recalculation |
| 8-3 | Stage Info in Project List | Critical | Epic/Story visible directly in list row |
| 8-4 | Fix Layout Width Bugs | High | Full-width on launch, eliminated margins |
| 8-5 | Favorites Sort First | High | Favorites appear at top, alphabetical within groups |
| 8-6 | Horizontal Split Layout | Medium | Detail panel below list (now default) |
| 8-7 | Config Display in TUI | Medium | Help overlay shows active config values |
| 8-8 | Clarify/Remove Confidence | Medium | Removed from TUI, kept in JSON/CLI |
| 8-9 | Visual Polish Bundle | Low | Emoji fallback, hidden pagination, documented focus indicator |
| 8-10 | Column Rebalancing | High | Percentage-based columns, `max_content_width` config |
| 8-11 | Periodic Stage Re-Detection | High | 30-second auto-refresh (configurable) |
| 8-12 | Horizontal Layout Height Handling | High | Height-priority algorithm, anchor point fix |
| 8-13 | fsnotify File Handle Leak Fix | P0 Critical | Explicit Remove() before Close() on macOS |
| 8-14 | Detail Panel Width Consistency | P3 Cosmetic | Row width padding for visual alignment |

**Note:** Stories 8-10 through 8-14 were discovered/added during the epic via correct-course workflow and testing feedback.

---

## Previous Retrospective Follow-Up (Epic 7)

| # | Action Item | Status | Notes |
|---|-------------|--------|-------|
| P1 | Pipeline summary output after completion | ⏳ Not addressed | Carried forward |
| P2 | "User-Visible Changes" section in stories | ⏳ Not addressed | Carried forward |

**Result:** 0/2 action items completed. Both carried forward again.

---

## What Went Well

### 1. Adaptive Scope Management
- Started with 9 stories from UX elicitation
- Added 5 more during the epic (8-10 through 8-14) via correct-course workflow
- All 14 completed - scope grew but delivery stayed strong

### 2. Critical Issues Discovered and Resolved
- 8-13 (fsnotify leak) - P0 caught before production impact
- 8-14 (width consistency) - Root cause found through user observation
- Real bugs found and fixed, not just feature delivery

### 3. Code Review Process Working
- Every story had meaningful review
- Multiple rounds on tough stories (8-12) led to correct solutions
- User observation in the loop caught what automated review missed

### 4. UX Elicitation Methodology Paid Off
- C→B→A methodology surfaced 18 issues
- P1 Critical (recursive watching) and P2 Critical (auto-refresh) both fixed
- Dashboard now optimized for glanceability

### 5. Iteration Process Works (Even When Hard)
- Story 8-12 required ~20 iterations to fully resolve
- User provided observations, Claude Code made assumptions and fixes
- Eventually got it right - process is healthy, not broken

---

## What Didn't Go Well

### 1. Story 8-12 Required ~20 Iterations
- Horizontal layout height handling was particularly challenging
- Visual/behavioral issues hard to debug without direct observation
- User doesn't know implementation details, had to guide via observations
- No automated way to catch anchor point stability issues

### 2. Critical Regression (8-13) Emerged Late
- fsnotify leak only manifested after extended runtime
- Triggered by Story 8-11's periodic refresh calling Watch() multiple times
- macOS-specific kqueue behavior wasn't anticipated
- No automated long-running session tests to catch this

### 3. Pipeline Visibility Gap (Carried Forward x2)
- Still no summary output after pipeline completion
- User had to read story files to see what changed
- Same issue from Epic 7 retro, still not addressed

---

## Key Discussion: TUI Behavioral Testing

### Problem Identified
Visual/behavioral bugs (like 8-12's anchor point issue) cannot be caught by:
- Unit tests (code runs, but visual behavior not verified)
- Code review (logic looks correct, but emergent behavior missed)
- Only user observation catches these, leading to many iterations

### Solution Proposed
**Create Epic 9: TUI Behavioral Testing Infrastructure** - a prerequisite before post-MVP work.

Analogous to Playwright for browsers, but for terminal UIs:
- Simulate different terminal sizes
- Capture output and compare (snapshot testing for TUI)
- Assert layout stability across navigation
- Long-running session tests (catch resource leaks)

### Stories Proposed for Epic 9

| Story | Focus | Priority |
|-------|-------|----------|
| 9-1 | Research TUI testing tools (teatest, vhs, custom) | High |
| 9-2 | Implement terminal size simulation framework | High |
| 9-3 | Anchor point stability tests (8-12 regression prevention) | High |
| 9-4 | Layout consistency tests across terminal sizes | High |
| 9-5 | Long-running session tests (catch leaks like 8-13) | Medium |
| 9-6 | Integration with CI pipeline | Medium |

---

## Epic Renumbering Decision

### Rationale
- Epic 5 (Hibernation) was deferred mid-MVP, creating a gap
- Epic 9 (Scalable Watching) is post-MVP
- New Epic 9 (TUI Testing) should be the gate before post-MVP
- Clean up numbering for clarity

### Final Epic Numbering

| Epic | Name | Status |
|------|------|--------|
| 1 | Foundation & First Launch | Done |
| 2 | Project Management & Detection | Done |
| 3 | Dashboard Visualization | Done |
| 3.5 | Storage Structure Alignment | Done |
| 4 | Agent Waiting Detection | Done |
| 4.5 | BMAD v6 Detector | Done |
| 4.6 | BMAD Stage Detection Validation | Done |
| 6 | Scripting & Automation | Done |
| 7 | Error Handling & Polish | Done |
| 8 | UX Polish | Done |
| **9** | **TUI Behavioral Testing** | **NEW - Pre-post-MVP Gate** |
| **10** | Scalable File Watching | Post-MVP *(was Epic 9)* |
| **11** | Project Hibernation | Post-MVP *(was Epic 5)* |

**Note:** No Epic 5 in final numbering. MVP is clean 1-8 sequence (with 3.5, 4.5, 4.6 sub-epics).

---

## Action Items

### Critical Path (Before Post-MVP)

| # | Action Item | Owner | Notes |
|---|-------------|-------|-------|
| C1 | Create Epic 9: TUI Behavioral Testing Infrastructure | SM | Draft epic with 6 stories as discussed |
| C2 | Renumber Epic 5 → Epic 11 in sprint-status.yaml | SM | Update all `5-*` keys to `11-*` |
| C3 | Renumber Epic 9 → Epic 10 in sprint-status.yaml | SM | Scalable File Watching moves to 10 |

### Process Improvements (Carried Forward)

| # | Action Item | Owner | Status |
|---|-------------|-------|--------|
| P1 | Pipeline summary output after completion | Dev Team | Carried forward (2nd time) |
| P2 | "User-Visible Changes" section in stories | SM | Carried forward (2nd time) |

### New Process Improvements

| # | Action Item | Owner | Notes |
|---|-------------|-------|-------|
| P3 | Add structured observation handoff in dev workflow | SM | "What to observe" section for visual changes |

---

## Lessons Learned

1. **Visual/behavioral bugs need specialized testing** - Unit tests and code review can't catch layout shifts or anchor point issues. TUI behavioral testing infrastructure is needed.

2. **Iteration is part of the process** - 20 iterations on 8-12 felt painful but produced the correct solution. The process works, but we should reduce iteration count with better testing.

3. **Extended runtime testing catches different bugs** - 8-13's leak only appeared after hours of use. Long-running session tests would catch this class of bug.

4. **Scope growth can be healthy** - Epic 8 grew from 9 to 14 stories via correct-course workflow. All delivered. Adaptive scope management works.

5. **MVP completion is a milestone** - Epic 8 marks MVP complete. Time to solidify with testing infrastructure before adding features.

---

## Retrospective Metrics

| Metric | Value |
|--------|-------|
| Stories Completed | 14/14 (100%) |
| Stories Added Mid-Epic | 5 (8-10 through 8-14) |
| Previous Action Items Resolved | 0/2 (carried forward) |
| New Action Items Created | 6 (3 critical, 3 process) |
| New Epic Created | Epic 9: TUI Behavioral Testing |
| Epics Renumbered | 2 (Epic 5→11, Epic 9→10) |

---

## MVP Completion Summary

**Epic 8 marks the completion of MVP for vibe-dash.**

All core functionality delivered:
- Project tracking and detection (Epics 1-4)
- BMAD v6 methodology support (Epics 4.5, 4.6)
- Scripting and automation (Epic 6)
- Error handling and polish (Epic 7)
- UX optimization for glanceability (Epic 8)

**Next phase:** Epic 9 (TUI Behavioral Testing) as the gate before post-MVP feature work.

---

*Retrospective facilitated by Bob (Scrum Master)*
*Document generated: 2025-12-31*
