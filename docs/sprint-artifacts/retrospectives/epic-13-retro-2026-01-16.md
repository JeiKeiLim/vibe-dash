# Epic 13 Retrospective - Dynamic Binary Name Polish

**Date:** 2026-01-16
**Facilitator:** Bob (Scrum Master)
**Epic:** Epic 13 - Dynamic Binary Name Polish
**Status:** Complete (3/3 stories done)

---

## Epic Summary

| Metric | Value |
|--------|-------|
| Stories Completed | 3/3 (100%) |
| Code Review Issues | 3 Medium (all fixed in Story 13-1) |
| Tests Added | ~10+ new tests |
| Total Test Count | 1302 (maintained) |
| Files Created/Modified | 8 files |
| FR Coverage | FR-P2-19, FR-P2-20 |

**Stories:**
- 13-1: Create Binary Name Resolution Utility ✅
- 13-2: Update Version Command to Use Dynamic Name ✅
- 13-3: Update Error Messages to Use Dynamic Name ✅

---

## Execution Mode

**Full Automation** - Epic was executed via `scripts/story-pipeline.sh` with spot-check validation by running the app. No manual intervention required.

---

## What Went Well

1. **Full automation success** - Story pipeline delivered 3/3 stories without manual intervention
2. **Clean TDD pattern** - `binaryNameFrom()` extraction enabled thorough unit testing
3. **Reusable implementation pattern** - Story 13-1 created foundation, 13-2 and 13-3 followed naturally
4. **Architectural discipline** - Utility correctly placed in adapter layer (os.Args is external state)
5. **Testing insight** - Pattern-based assertions solve `os.Args[0]` test binary issue
6. **Scope discipline** - No scope creep, both FRs fully addressed

---

## Challenges

None significant. This was a clean, well-scoped quick win epic.

The only minor friction was 3 medium code review fixes in Story 13-1:
- M1: Enhanced test to verify result matches `filepath.Base(os.Args[0])`
- M2: Added documentation for why empty Args branch is untestable
- M3: Moved package doc comment placement

All were standard polish items handled by the pipeline.

---

## Lessons Learned

### L1: Well-Specified Quick Win Epics Excel with Full Automation

Epic 13's success validates that well-specified, focused epics with clear implementation patterns can be reliably delivered through the story pipeline without manual intervention.

**Conditions for success:**
- Small scope (3 stories)
- Clear implementation pattern
- No ambiguity in requirements
- Sequential but simple dependencies

### L2: Pattern-Based Test Assertions for os.Args[0]

When testing code that uses `os.Args[0]`, the value during tests is the test binary name (e.g., `list.test`), not the production binary name.

**Solution:** Use pattern-based assertions:
```go
// Instead of:
if !strings.Contains(output, "vdash add") {

// Use:
if !strings.Contains(output, " add .'") {
```

### L3: Extract Testable Functions to Avoid Global State

The `binaryNameFrom(arg0 string)` function was extracted from `BinaryName()` to enable unit testing without mocking global `os.Args`.

**Pattern:**
```go
// Public function uses global state
func BinaryName() string {
    if len(os.Args) == 0 {
        return DefaultBinaryName
    }
    return binaryNameFrom(os.Args[0])
}

// Testable function takes explicit parameter
func binaryNameFrom(arg0 string) string {
    // ... logic here
}
```

---

## Action Items

None required. Epic 13 validated the current process.

---

## Technical Debt

None incurred. Clean implementation with no shortcuts.

---

## Team Agreements

- Continue using story pipeline for well-scoped epics
- Spot-check by running the app periodically
- Document issues in stories or retrospectives for feedback loop

---

## Next Epic Preparation

**Epic 14: Methodology Switching Detection**

**Overview:**
- 5 stories (sequential dependency: 14-1 → 14-2 → 14-3 → 14-4 → 14-5)
- FR Coverage: FR-P2-7 through FR-P2-11
- Fixes first-match-wins bug with most-recent-artifact-wins selection

**Preparation Needed:**
- None - existing detection infrastructure is in place

**Complexity Areas to Watch:**
- Timestamp comparison edge cases (within 1 hour = tie-breaker)
- TUI changes for displaying coexistence warning
- Test coverage for boundary conditions around 1-hour threshold

**Blockers:**
- None identified

---

## Participants

- Jongkuk Lim (Project Lead)
- Bob (Scrum Master) - Facilitator
- Alice (Product Owner)
- Charlie (Senior Dev)
- Amelia (Dev)
- Winston (Architect)
- Murat (TEA)
- John (PM)

---

## Summary

Epic 13 was a textbook quick win - small scope, clear value, clean execution. The full automation success validates the story pipeline maturity and the spot-check workflow scales effectively for AI-assisted development.

**Verdict:** Process working well. No changes needed. Ready for Epic 14.
